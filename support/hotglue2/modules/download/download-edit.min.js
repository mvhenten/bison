$(".download").live("glue-upload-dynamic-early",function(c,d,b,a){if(d=="center"){$(this).css("left",(b-$(this).outerWidth()/2)+"px");$(this).css("top",(a-$(this).outerHeight()/2)+"px")}else{$(this).css("left",b+"px");$(this).css("top",a+"px")}$(this).css("visibility",$(this).data("orig_visibility"));$(this).removeData("orig_visibility");$.glue.object.register(this);$.glue.object.save(this)});$(document).ready(function(){$.glue.contextmenu.veto("download","object-link");var a;a=$('<img src="'+$.glue.base_url+'img/download.png" alt="btn" title="download file" width="32" height="32">');$(a).bind("click",function(c){var b=$(this).data("owner");window.location=$.glue.base_url+"?"+$(b).attr("id")+"&download=1"});$.glue.contextmenu.register("download","download-download",a);a=$('<div alt="btn" style="height: 32px; width: 32px;">');$(a).bind("glue-menu-activate",function(d){var c=$(this).data("owner");var b=this;$.glue.backend({method:"glue.load_object",name:$(c).attr("id")},function(e){if(e["download-public"]=="public"){$(b).addClass("glue-menu-enabled");$(b).removeClass("glue-menu-disabled");$(b).attr("title","this object is shown to everyone - click to make it private")}else{$(b).removeClass("glue-menu-enabled");$(b).addClass("glue-menu-disabled");$(b).attr("title","this object is only shown while editing - click to make it public")}})});$(a).bind("click",function(c){var b=$(this).data("owner");if($(this).hasClass("glue-menu-enabled")){$(this).removeClass("glue-menu-enabled");$(this).addClass("glue-menu-disabled");$(this).attr("title","this object is only shown while editing - click to make it public");$.glue.backend({method:"glue.object_remove_attr",name:$(b).attr("id"),attr:"download-public"})}else{if($(this).hasClass("glue-menu-disabled")){$(this).addClass("glue-menu-enabled");$(this).removeClass("glue-menu-disabled");$(this).attr("title","this object is shown to everyone - click to make it private");$.glue.backend({method:"glue.update_object",name:$(b).attr("id"),"download-public":"public"})}}});$.glue.contextmenu.register("download","download-public",a);$.glue.object.register_alter_pre_save("download",function(b,c){$(b).children(".download-ext").remove()})});
